<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pivot Point Pro Calculator - PT RFB CIPUTRA SURABAYA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c1a2d 0%, #152642 100%);
            color: #e0e0e0;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .container {
            background: rgba(18, 30, 52, 0.95);
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(64, 128, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 25px;
            border-bottom: 1px solid rgba(64, 128, 255, 0.2);
            position: relative;
        }
        
        header::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 3px;
            background: linear-gradient(90deg, #ff6b00, #ffd166, #06d6a0);
            border-radius: 3px;
        }
        
        h1 {
            color: #fff;
            margin-bottom: 10px;
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: 1px;
            background: linear-gradient(90deg, #ff6b00, #ffd166, #06d6a0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            color: #8a9bb8;
            font-size: 1.1rem;
            font-weight: 300;
            letter-spacing: 0.5px;
        }
        
        .company-name {
            color: #06d6a0;
            font-weight: 600;
            margin-top: 8px;
            font-size: 1.2rem;
            letter-spacing: 1px;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
        }
        
        .input-section {
            flex: 1;
            min-width: 350px;
            background: rgba(13, 22, 40, 0.7);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid rgba(64, 128, 255, 0.15);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .result-section {
            flex: 1;
            min-width: 350px;
        }
        
        .section-title {
            color: #ffd166;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 209, 102, 0.3);
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.4rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .section-title i {
            font-size: 1.3rem;
            color: #ff6b00;
        }
        
        .form-group {
            margin-bottom: 22px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: #a6b3cc;
            font-size: 0.95rem;
            letter-spacing: 0.3px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 14px 16px;
            background: rgba(10, 18, 33, 0.8);
            border: 1px solid rgba(64, 128, 255, 0.3);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
            color: #e0e0e0;
            font-weight: 400;
        }
        
        textarea {
            resize: vertical;
            min-height: 80px;
            font-family: 'Inter', sans-serif;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #ff6b00;
            box-shadow: 0 0 0 3px rgba(255, 107, 0, 0.2);
            background: rgba(10, 18, 33, 0.9);
        }
        
        .market-type {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .market-option {
            flex: 1;
            text-align: center;
            padding: 18px 10px;
            border: 2px solid rgba(64, 128, 255, 0.2);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(10, 18, 33, 0.5);
        }
        
        .market-option:hover {
            border-color: #ff6b00;
            background: rgba(255, 107, 0, 0.1);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 107, 0, 0.2);
        }
        
        .market-option.active {
            border-color: #ff6b00;
            background: rgba(255, 107, 0, 0.15);
            box-shadow: 0 5px 15px rgba(255, 107, 0, 0.25);
        }
        
        .period-type {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .period-option {
            flex: 1;
            text-align: center;
            padding: 14px 8px;
            border: 2px solid rgba(64, 128, 255, 0.2);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            background: rgba(10, 18, 33, 0.5);
            color: #8a9bb8;
            font-size: 0.95rem;
        }
        
        .period-option:hover {
            border-color: #06d6a0;
            background: rgba(6, 214, 160, 0.1);
            color: #06d6a0;
            transform: translateY(-2px);
        }
        
        .period-option.active {
            border-color: #06d6a0;
            background: rgba(6, 214, 160, 0.2);
            color: #06d6a0;
            box-shadow: 0 5px 15px rgba(6, 214, 160, 0.2);
        }
        
        .market-icon {
            font-size: 2.2rem;
            margin-bottom: 12px;
        }
        
        .gold-option .market-icon {
            color: #ffd166;
            text-shadow: 0 0 10px rgba(255, 209, 102, 0.3);
        }
        
        .hangseng-option .market-icon {
            color: #06d6a0;
            text-shadow: 0 0 10px rgba(6, 214, 160, 0.3);
        }
        
        .date-range {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        .date-range input {
            flex: 1;
        }
        
        .period-inputs {
            background: rgba(6, 214, 160, 0.05);
            padding: 18px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #06d6a0;
            border: 1px solid rgba(6, 214, 160, 0.2);
        }
        
        .period-info {
            font-size: 0.85rem;
            color: #8a9bb8;
            margin-top: 8px;
            font-style: italic;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 35px;
        }
        
        button {
            padding: 16px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            flex: 1;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .calculate-btn {
            background: linear-gradient(135deg, #ff6b00 0%, #ff8e42 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(255, 107, 0, 0.3);
        }
        
        .calculate-btn:hover {
            background: linear-gradient(135deg, #e85c00 0%, #ff7a2e 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 107, 0, 0.4);
        }
        
        .download-btn {
            background: linear-gradient(135deg, #06d6a0 0%, #0ce6b2 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(6, 214, 160, 0.3);
        }
        
        .download-btn:hover {
            background: linear-gradient(135deg, #05c191 0%, #0bd4a7 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(6, 214, 160, 0.4);
        }
        
        .reset-btn {
            background: rgba(64, 128, 255, 0.1);
            color: #a6b3cc;
            border: 1px solid rgba(64, 128, 255, 0.3);
        }
        
        .reset-btn:hover {
            background: rgba(64, 128, 255, 0.2);
            transform: translateY(-3px);
            border-color: rgba(64, 128, 255, 0.5);
        }
        
        .result-box {
            background: linear-gradient(135deg, rgba(13, 22, 40, 0.9) 0%, rgba(18, 30, 52, 0.9) 100%);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 30px;
            border: 1px solid rgba(64, 128, 255, 0.2);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .result-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff6b00, #ffd166, #06d6a0);
        }
        
        .market-data {
            margin-bottom: 25px;
        }
        
        .data-row {
            display: flex;
            justify-content: space-between;
            padding: 14px 0;
            border-bottom: 1px solid rgba(64, 128, 255, 0.1);
            transition: background 0.2s;
        }
        
        .data-row:hover {
            background: rgba(64, 128, 255, 0.05);
            border-radius: 6px;
            padding-left: 10px;
            padding-right: 10px;
        }
        
        .data-label {
            font-weight: 500;
            color: #a6b3cc;
            font-size: 0.95rem;
        }
        
        .data-value {
            font-weight: 600;
            color: #fff;
            font-size: 1.05rem;
        }
        
        .range-highlight {
            color: #ffd166;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 209, 102, 0.3);
        }
        
        .profit-info {
            background: rgba(6, 214, 160, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
            border: 1px solid rgba(6, 214, 160, 0.2);
        }
        
        .profit-details {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .profit-item {
            background: rgba(10, 18, 33, 0.8);
            padding: 15px;
            border-radius: 8px;
            flex: 1;
            min-width: 200px;
            border: 1px solid rgba(6, 214, 160, 0.3);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }
        
        .profit-label {
            font-weight: 600;
            color: #06d6a0;
            margin-bottom: 8px;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
        }
        
        .analysis-section {
            margin-top: 35px;
        }
        
        .resistance, .support {
            margin-bottom: 30px;
        }
        
        .level {
            display: flex;
            justify-content: space-between;
            padding: 14px 18px;
            margin-bottom: 10px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s;
            border: 1px solid transparent;
        }
        
        .level:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .resistance .level {
            background: linear-gradient(90deg, rgba(198, 40, 40, 0.1) 0%, rgba(198, 40, 40, 0.05) 100%);
            color: #ff6b6b;
            border-left: 4px solid #ff6b6b;
        }
        
        .support .level {
            background: linear-gradient(90deg, rgba(46, 125, 50, 0.1) 0%, rgba(46, 125, 50, 0.05) 100%);
            color: #06d6a0;
            border-left: 4px solid #06d6a0;
        }
        
        .pivot-level {
            background: linear-gradient(90deg, rgba(255, 143, 0, 0.15) 0%, rgba(255, 143, 0, 0.1) 100%) !important;
            color: #ffd166 !important;
            font-weight: bold;
            font-size: 1.2rem;
            margin: 20px 0;
            padding: 18px;
            border-left: 4px solid #ffd166 !important;
            text-align: center;
            letter-spacing: 0.5px;
        }
        
        .signature {
            margin-top: 35px;
            padding-top: 25px;
            border-top: 1px solid rgba(64, 128, 255, 0.2);
            color: #a6b3cc;
            position: relative;
        }
        
        .signature::before {
            content: '';
            position: absolute;
            top: -1px;
            left: 0;
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, #ff6b00, #ffd166);
            border-radius: 3px;
        }
        
        .signature-text {
            font-style: italic;
            margin-bottom: 12px;
            color: #8a9bb8;
        }
        
        .signature-name {
            font-weight: 600;
            font-size: 1.2rem;
            color: #fff;
            letter-spacing: 1px;
        }
        
        .news-section {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid rgba(64, 128, 255, 0.2);
        }
        
        .news-title {
            font-weight: 600;
            color: #ffd166;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            letter-spacing: 0.5px;
        }
        
        /* PERBAIKAN: Warna yang lebih kontras untuk market news */
        .news-content {
            font-style: italic;
            color: #ffffff; /* Warna putih untuk kontras maksimal */
            line-height: 1.6;
            background: rgba(255, 209, 102, 0.1); /* Background emas transparan */
            padding: 16px;
            border-radius: 8px;
            border-left: 4px solid #ffd166;
            border: 1px solid rgba(255, 209, 102, 0.3);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .period-indicator {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 10px;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .daily-indicator {
            background: linear-gradient(135deg, #1565c0 0%, #1e88e5 100%);
            color: white;
            box-shadow: 0 3px 10px rgba(21, 101, 192, 0.3);
        }
        
        .weekly-indicator {
            background: linear-gradient(135deg, #7b1fa2 0%, #9c27b0 100%);
            color: white;
            box-shadow: 0 3px 10px rgba(123, 31, 162, 0.3);
        }
        
        .monthly-indicator {
            background: linear-gradient(135deg, #ef6c00 0%, #ff9800 100%);
            color: white;
            box-shadow: 0 3px 10px rgba(239, 108, 0, 0.3);
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 25px;
            border-top: 1px solid rgba(64, 128, 255, 0.2);
            color: #8a9bb8;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
        }
        
        footer::before {
            content: '';
            display: block;
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, #ff6b00, #06d6a0);
            margin: 0 auto 20px;
            border-radius: 3px;
        }
        
        @media (max-width: 992px) {
            .content {
                flex-direction: column;
            }
            
            .input-section, .result-section {
                min-width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .buttons {
                flex-direction: column;
            }
            
            .market-type, .period-type {
                flex-direction: column;
            }
            
            .date-range {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .container {
                padding: 20px;
            }
        }
        
        .notification {
            padding: 18px;
            border-radius: 10px;
            margin-bottom: 25px;
            display: none;
            border-left: 5px solid;
            font-weight: 500;
            letter-spacing: 0.3px;
        }
        
        .success {
            background: rgba(6, 214, 160, 0.1);
            color: #06d6a0;
            border-left-color: #06d6a0;
        }
        
        .error {
            background: rgba(255, 107, 0, 0.1);
            color: #ff6b6b;
            border-left-color: #ff6b6b;
        }
        
        .market-indicator {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 10px;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .gold-indicator {
            background: linear-gradient(135deg, #ffd166 0%, #ffb347 100%);
            color: #0c1a2d;
            box-shadow: 0 3px 10px rgba(255, 209, 102, 0.3);
        }
        
        .hangseng-indicator {
            background: linear-gradient(135deg, #06d6a0 0%, #0ce6b2 100%);
            color: white;
            box-shadow: 0 3px 10px rgba(6, 214, 160, 0.3);
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .date-separator {
            color: #8a9bb8;
            font-weight: 600;
            padding: 0 8px;
        }
        
        .market-option h3 {
            color: #fff;
            margin-bottom: 8px;
            font-size: 1.2rem;
        }
        
        .market-option p {
            color: #8a9bb8;
            font-size: 0.85rem;
            font-weight: 300;
        }
        
        .result-header h3 {
            color: #fff;
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .result-header h3 i {
            color: #ffd166;
        }
        
        .glow-effect {
            position: relative;
        }
        
        .glow-effect::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            box-shadow: 0 0 20px rgba(255, 107, 0, 0.3);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: -1;
        }
        
        .glow-effect:hover::after {
            opacity: 1;
        }
        
        /* Trading chart inspired elements */
        .chart-line {
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 100%;
            opacity: 0.1;
            pointer-events: none;
            background: linear-gradient(90deg, transparent, rgba(255, 107, 0, 0.2), transparent);
            clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%, 0% 50%, 25% 40%, 50% 60%, 75% 30%, 100% 50%, 100% 100%, 0% 100%);
        }
        
        /* Professional trading terminal style */
        .terminal-style {
            position: relative;
            overflow: hidden;
        }
        
        .terminal-style::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 0%, rgba(64, 128, 255, 0.05) 50%, transparent 100%),
                radial-gradient(circle at 20% 80%, rgba(255, 107, 0, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(6, 214, 160, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
        
        .terminal-style > * {
            position: relative;
            z-index: 1;
        }
        
        /* Grid pattern for professional look */
        .grid-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(rgba(64, 128, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(64, 128, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            pointer-events: none;
            z-index: 0;
            opacity: 0.3;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container terminal-style">
        <div class="grid-bg"></div>
        <div class="chart-line"></div>
        
        <header>
            <h1><i class="fas fa-chart-candlestick"></i> PIVOT POINT PRO CALCULATOR</h1>
            <p class="subtitle">Analisis Teknikal Profesional untuk Trader</p>
            <p class="company-name">PT RFB CIPUTRA SURABAYA</p>
        </header>
        
        <div class="notification" id="notification"></div>
        
        <div class="content">
            <div class="input-section glow-effect">
                <h2 class="section-title"><i class="fas fa-sliders-h"></i> INPUT DATA MARKET</h2>
                
                <div class="market-type">
                    <div class="market-option gold-option active" id="goldOption">
                        <div class="market-icon">
                            <i class="fas fa-gem"></i>
                        </div>
                        <h3>GOLD</h3>
                        <p>1 Point = $100 / Rp 1.000.000</p>
                    </div>
                    <div class="market-option hangseng-option" id="hangsengOption">
                        <div class="market-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3>HANG SENG INDEX</h3>
                        <p>1 Point = $5 / Rp 50.000</p>
                    </div>
                </div>
                
                <input type="hidden" id="marketType" value="gold">
                
                <div class="period-type">
                    <div class="period-option active" id="dailyOption">DAILY</div>
                    <div class="period-option" id="weeklyOption">WEEKLY</div>
                    <div class="period-option" id="monthlyOption">MONTHLY</div>
                </div>
                
                <input type="hidden" id="periodType" value="daily">
                
                <div class="period-inputs" id="periodInputs">
                    <!-- Period inputs will be dynamically inserted here -->
                </div>
                
                <div class="form-group">
                    <label for="open"><i class="fas fa-arrow-up-from-bracket"></i> OPEN PRICE</label>
                    <input type="number" id="open" step="0.01" placeholder="Enter opening price" value="4674.23">
                </div>
                
                <div class="form-group">
                    <label for="high"><i class="fas fa-arrow-trend-up"></i> HIGH PRICE</label>
                    <input type="number" id="high" step="0.01" placeholder="Enter highest price" value="4993.69">
                </div>
                
                <div class="form-group">
                    <label for="low"><i class="fas fa-arrow-trend-down"></i> LOW PRICE</label>
                    <input type="number" id="low" step="0.01" placeholder="Enter lowest price" value="4666.51">
                </div>
                
                <div class="form-group">
                    <label for="close"><i class="fas fa-arrow-down-to-bracket"></i> CLOSE PRICE</label>
                    <input type="number" id="close" step="0.01" placeholder="Enter closing price" value="4950.61">
                </div>
                
                <div class="form-group">
                    <label for="analysisDateStart"><i class="fas fa-calendar-alt"></i> ANALYSIS START DATE (Next Period)</label>
                    <input type="date" id="analysisDateStart" value="2026-02-04">
                </div>
                
                <div class="form-group" id="analysisDateEndGroup" style="display: none;">
                    <label for="analysisDateEnd"><i class="fas fa-calendar-alt"></i> ANALYSIS END DATE (Next Period)</label>
                    <input type="date" id="analysisDateEnd" value="2026-02-10">
                </div>
                
                <div class="form-group">
                    <label for="signature"><i class="fas fa-signature"></i> ANALYST SIGNATURE</label>
                    <input type="text" id="signature" placeholder="Enter analyst name" value="Kahfi">
                </div>
                
                <div class="form-group">
                    <label for="notes"><i class="fas fa-bullhorn"></i> MARKET NEWS (Optional)</label>
                    <textarea id="notes" placeholder="Enter relevant market news or insights...">Federal Reserve signals potential rate cuts in Q2 2026, boosting gold prices. Hang Seng Index shows resilience amid regional economic recovery.</textarea>
                </div>
                
                <div class="buttons">
                    <button class="calculate-btn" id="calculateBtn">
                        <i class="fas fa-calculator"></i> CALCULATE PIVOT
                    </button>
                    <button class="reset-btn" id="resetBtn">
                        <i class="fas fa-redo"></i> RESET
                    </button>
                </div>
            </div>
            
            <div class="result-section">
                <h2 class="section-title"><i class="fas fa-chart-bar"></i> PIVOT POINT ANALYSIS</h2>
                
                <div class="result-box glow-effect">
                    <div class="result-header">
                        <h3>
                            <i class="fas fa-calendar-day"></i> 
                            <span id="result-date">Tuesday, February 03, 2026</span>
                        </h3>
                        <div>
                            <span class="market-indicator gold-indicator" id="marketIndicator">GOLD</span>
                            <span class="period-indicator daily-indicator" id="periodIndicator">DAILY</span>
                        </div>
                    </div>
                    
                    <div class="market-data">
                        <div class="data-row">
                            <span class="data-label">Open</span>
                            <span class="data-value" id="result-open">4674.23</span>
                        </div>
                        
                        <div class="data-row">
                            <span class="data-label">High</span>
                            <span class="data-value" id="result-high">4993.69</span>
                        </div>
                        
                        <div class="data-row">
                            <span class="data-label">Low</span>
                            <span class="data-value" id="result-low">4666.51</span>
                        </div>
                        
                        <div class="data-row">
                            <span class="data-label">Close</span>
                            <span class="data-value" id="result-close">4950.61</span>
                        </div>
                        
                        <div class="data-row">
                            <span class="data-label">Price Movement Range</span>
                            <span class="data-value range-highlight" id="result-range">327.18 points</span>
                        </div>
                    </div>
                    
                    <div class="profit-info">
                        <p><strong id="point-value-text">1 point value = $100 / Rp 1.000.000</strong></p>
                        <p><strong>Taking Profit Probability</strong> based on movement range of <span id="result-range-value">327.18</span> points:</p>
                        
                        <div class="profit-details">
                            <div class="profit-item">
                                <div class="profit-label">IN USD:</div>
                                <div id="profit-usd">$32,718.00</div>
                            </div>
                            <div class="profit-item">
                                <div class="profit-label">IN IDR:</div>
                                <div id="profit-idr">Rp 327.180.000</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="analysis-section">
                    <h3 class="section-title"><i class="fas fa-chart-line"></i> TODAY'S ANALYSIS</h3>
                    <p style="margin-bottom: 25px; font-style: italic; color: #8a9bb8;" id="analysis-date-result">Thursday, February 04, 2026</p>
                    
                    <div class="resistance">
                        <h4 style="color: #ff6b6b; margin-bottom: 15px;"><i class="fas fa-arrow-up"></i> RESISTANCE LEVELS</h4>
                        <div class="level" id="r1">R1: <span>5074.03</span></div>
                        <div class="level" id="r2">R2: <span>5197.45</span></div>
                        <div class="level" id="r3">R3: <span>5524.63</span></div>
                        <div class="level" id="r4">R4: <span>5851.81</span></div>
                    </div>
                    
                    <div class="pivot-level level" id="pivot">
                        <i class="fas fa-bullseye"></i> PIVOT POINT = <span>4870.27</span>
                    </div>
                    
                    <div class="support">
                        <h4 style="color: #06d6a0; margin-bottom: 15px;"><i class="fas fa-arrow-down"></i> SUPPORT LEVELS</h4>
                        <div class="level" id="s1">S1: <span>4746.85</span></div>
                        <div class="level" id="s2">S2: <span>4543.09</span></div>
                        <div class="level" id="s3">S3: <span>4215.91</span></div>
                        <div class="level" id="s4">S4: <span>3888.73</span></div>
                    </div>
                </div>
                
                <div class="signature">
                    <p class="signature-text">Best regards,</p>
                    <p class="signature-name" id="signature-result">Kahfi</p>
                    <p style="color: #06d6a0; font-weight: 500;">PT RFB CIPUTRA SURABAYA</p>
                </div>
                
                <div class="news-section" id="news-display" style="display: block;">
                    <div class="news-title">
                        <i class="fas fa-newspaper"></i> MARKET NEWS
                    </div>
                    <div class="news-content" id="news-text">Federal Reserve signals potential rate cuts in Q2 2026, boosting gold prices. Hang Seng Index shows resilience amid regional economic recovery.</div>
                </div>
                
                <div class="buttons">
                    <button class="download-btn" id="downloadBtn">
                        <i class="fas fa-file-export"></i> EXPORT ANALYSIS
                    </button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Â© 2026 Pivot Point Pro Calculator - Professional Trading Tool</p>
            <p style="margin-top: 10px; font-size: 0.8rem; color: #6b7b9c;">For professional market analysis and trading decisions</p>
        </footer>
    </div>

    <!-- Library untuk download PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <script>
        // Konfigurasi untuk setiap jenis pasar
        const marketConfig = {
            gold: {
                name: "GOLD",
                pointValueUSD: 100,
                pointValueIDR: 1000000,
                color: "#ffd166",
                indicatorClass: "gold-indicator",
                icon: "fas fa-gem"
            },
            hangseng: {
                name: "HANG SENG INDEX",
                pointValueUSD: 5,
                pointValueIDR: 50000,
                color: "#06d6a0",
                indicatorClass: "hangseng-indicator",
                icon: "fas fa-chart-line"
            }
        };
        
        // Konfigurasi untuk setiap periode
        const periodConfig = {
            daily: {
                name: "DAILY",
                label: "Analysis Date",
                info: "Daily market analysis",
                analysisText: "TODAY'S ANALYSIS",
                indicatorClass: "daily-indicator",
                dateFormat: { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' },
                nextPeriodLabel: "Analysis Date (Tomorrow)"
            },
            weekly: {
                name: "WEEKLY",
                label: "Date Range (Weekly)",
                info: "Weekly market analysis (custom date range)",
                analysisText: "WEEKLY ANALYSIS",
                indicatorClass: "weekly-indicator",
                dateFormat: { year: 'numeric', month: 'long', day: 'numeric' },
                nextPeriodLabel: "Date Range (Next Week)"
            },
            monthly: {
                name: "MONTHLY",
                label: "Date Range (Monthly)",
                info: "Monthly market analysis (custom date range)",
                analysisText: "MONTHLY ANALYSIS",
                indicatorClass: "monthly-indicator",
                dateFormat: { year: 'numeric', month: 'long' },
                nextPeriodLabel: "Date Range (Next Month)"
            }
        };
        
        // Variabel global untuk konfigurasi pasar dan periode saat ini
        let currentMarket = 'gold';
        let currentPeriod = 'daily';
        
        // Fungsi untuk menghitung pivot point
        function calculatePivotPoints(open, high, low, close) {
            // Pivot Point (PP)
            const pivot = (high + low + close) / 3;
            
            // Resistance Levels
            const r1 = (2 * pivot) - low;
            const r2 = pivot + (high - low);
            const r3 = high + 2 * (pivot - low);
            const r4 = r3 + (high - low);
            
            // Support Levels
            const s1 = (2 * pivot) - high;
            const s2 = pivot - (high - low);
            const s3 = low - 2 * (high - pivot);
            const s4 = s3 - (high - low);
            
            // Range pergerakan harga
            const range = high - low;
            
            return {
                pivot: pivot.toFixed(2),
                r1: r1.toFixed(2),
                r2: r2.toFixed(2),
                r3: r3.toFixed(2),
                r4: r4.toFixed(2),
                s1: s1.toFixed(2),
                s2: s2.toFixed(2),
                s3: s3.toFixed(2),
                s4: s4.toFixed(2),
                range: range.toFixed(2)
            };
        }
        
        // Fungsi untuk menghitung profit berdasarkan jenis pasar
        function calculateProfit(range, marketType) {
            const config = marketConfig[marketType];
            const profitUSD = (range * config.pointValueUSD).toFixed(2);
            const profitIDR = (range * config.pointValueIDR).toLocaleString('id-ID');
            
            return {
                usd: `$${parseFloat(profitUSD).toLocaleString('en-US', {minimumFractionDigits: 2})}`,
                idr: `Rp ${profitIDR}`,
                pointText: `1 point value = $${config.pointValueUSD} / Rp ${config.pointValueIDR.toLocaleString('id-ID')}`
            };
        }
        
        // Fungsi untuk menampilkan notifikasi
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }
        
        // Fungsi untuk mengubah tampilan input berdasarkan periode
        function updatePeriodInputs() {
            const periodConfigCurrent = periodConfig[currentPeriod];
            const periodInputs = document.getElementById('periodInputs');
            const analysisDateEndGroup = document.getElementById('analysisDateEndGroup');
            
            if (currentPeriod === 'daily') {
                periodInputs.innerHTML = `
                    <div class="form-group">
                        <label for="date"><i class="far fa-calendar"></i> ${periodConfigCurrent.label}</label>
                        <div class="date-range">
                            <input type="date" id="date" value="2026-02-03">
                        </div>
                        <div class="period-info" id="periodInfo">${periodConfigCurrent.info}</div>
                    </div>
                `;
                
                // Update label untuk analisis date
                document.querySelector('label[for="analysisDateStart"]').innerHTML = 
                    `<i class="fas fa-calendar-alt"></i> ${periodConfigCurrent.nextPeriodLabel}`;
                    
                // Sembunyikan input tanggal akhir untuk harian
                analysisDateEndGroup.style.display = 'none';
                
            } else if (currentPeriod === 'weekly' || currentPeriod === 'monthly') {
                periodInputs.innerHTML = `
                    <div class="form-group">
                        <label for="dateStart"><i class="far fa-calendar"></i> ${periodConfigCurrent.label}</label>
                        <div class="date-range">
                            <input type="date" id="dateStart" value="2026-02-03">
                            <span class="date-separator">to</span>
                            <input type="date" id="dateEnd" value="${currentPeriod === 'weekly' ? '2026-02-09' : '2026-02-28'}">
                        </div>
                        <div class="period-info" id="periodInfo">${periodConfigCurrent.info}</div>
                    </div>
                `;
                
                // Update label untuk analisis date
                document.querySelector('label[for="analysisDateStart"]').innerHTML = 
                    `<i class="fas fa-calendar-alt"></i> ${periodConfigCurrent.nextPeriodLabel}`;
                    
                // Tampilkan input tanggal akhir untuk mingguan/bulanan
                analysisDateEndGroup.style.display = 'block';
                
                // Update label untuk tanggal akhir analisis
                document.querySelector('label[for="analysisDateEnd"]').innerHTML = 
                    `<i class="fas fa-calendar-alt"></i> ${currentPeriod === 'weekly' ? 'Analysis End Date (Next Week)' : 'Analysis End Date (Next Month)'}`;
            }
        }
        
        // Fungsi untuk mengupdate tampilan hasil
        function updateResults() {
            // Ambil nilai input berdasarkan periode
            let dateStartInput, dateEndInput;
            
            if (currentPeriod === 'daily') {
                dateStartInput = document.getElementById('date').value;
                dateEndInput = dateStartInput; // Untuk harian, tanggal awal dan akhir sama
            } else {
                dateStartInput = document.getElementById('dateStart').value;
                dateEndInput = document.getElementById('dateEnd').value;
            }
            
            const analysisDateStartInput = document.getElementById('analysisDateStart').value;
            const analysisDateEndInput = document.getElementById('analysisDateEnd').value;
            const open = parseFloat(document.getElementById('open').value);
            const high = parseFloat(document.getElementById('high').value);
            const low = parseFloat(document.getElementById('low').value);
            const close = parseFloat(document.getElementById('close').value);
            const signature = document.getElementById('signature').value;
            const notes = document.getElementById('notes').value;
            
            // Validasi input
            if (isNaN(open) || isNaN(high) || isNaN(low) || isNaN(close)) {
                showNotification("Please enter all price values correctly.", "error");
                return;
            }
            
            if (high < low) {
                showNotification("High price must be greater than Low price.", "error");
                return;
            }
            
            if (open < 0 || high < 0 || low < 0 || close < 0) {
                showNotification("Price values cannot be negative.", "error");
                return;
            }
            
            // Validasi tanggal untuk periode mingguan/bulanan
            if (currentPeriod !== 'daily') {
                const startDate = new Date(dateStartInput);
                const endDate = new Date(dateEndInput);
                
                if (endDate < startDate) {
                    showNotification("End date cannot be earlier than start date.", "error");
                    return;
                }
                
                // Validasi tanggal analisis berikutnya
                const analysisStartDate = new Date(analysisDateStartInput);
                const analysisEndDate = new Date(analysisDateEndInput);
                
                if (analysisEndDate < analysisStartDate) {
                    showNotification("Analysis end date cannot be earlier than analysis start date.", "error");
                    return;
                }
            }
            
            // Hitung pivot points
            const results = calculatePivotPoints(open, high, low, close);
            
            // Format tanggal berdasarkan periode
            const periodConfigCurrent = periodConfig[currentPeriod];
            let formattedDate = '';
            let formattedAnalysisDate = '';
            
            if (currentPeriod === 'daily') {
                const dateObj = new Date(dateStartInput);
                const analysisDateObj = new Date(analysisDateStartInput);
                
                formattedDate = dateObj.toLocaleDateString('en-US', periodConfigCurrent.dateFormat);
                formattedAnalysisDate = analysisDateObj.toLocaleDateString('en-US', periodConfigCurrent.dateFormat);
            } else {
                const startDateObj = new Date(dateStartInput);
                const endDateObj = new Date(dateEndInput);
                const analysisStartDateObj = new Date(analysisDateStartInput);
                const analysisEndDateObj = new Date(analysisDateEndInput);
                
                // Format rentang tanggal
                if (currentPeriod === 'weekly') {
                    formattedDate = `${startDateObj.toLocaleDateString('en-US', { month: 'long', day: 'numeric' })} - ${endDateObj.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}`;
                    formattedAnalysisDate = `${analysisStartDateObj.toLocaleDateString('en-US', { month: 'long', day: 'numeric' })} - ${analysisEndDateObj.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}`;
                } else {
                    formattedDate = `${startDateObj.toLocaleDateString('en-US', { month: 'long', day: 'numeric' })} - ${endDateObj.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}`;
                    formattedAnalysisDate = `${analysisStartDateObj.toLocaleDateString('en-US', { month: 'long', day: 'numeric' })} - ${analysisEndDateObj.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}`;
                }
            }
            
            // Hitung profit berdasarkan jenis pasar
            const profitResults = calculateProfit(parseFloat(results.range), currentMarket);
            
            // Update tampilan
            document.getElementById('result-date').textContent = formattedDate;
            document.getElementById('result-open').textContent = open.toFixed(2);
            document.getElementById('result-high').textContent = high.toFixed(2);
            document.getElementById('result-low').textContent = low.toFixed(2);
            document.getElementById('result-close').textContent = close.toFixed(2);
            document.getElementById('result-range').textContent = `${results.range} points`;
            document.getElementById('result-range-value').textContent = results.range;
            
            // Update profit info
            document.getElementById('point-value-text').textContent = profitResults.pointText;
            document.getElementById('profit-usd').textContent = profitResults.usd;
            document.getElementById('profit-idr').textContent = profitResults.idr;
            
            // Update tanggal analisis
            document.getElementById('analysis-date-result').textContent = formattedAnalysisDate;
            
            // Update teks periode analisis
            document.getElementById('analysis-period-text').textContent = periodConfigCurrent.analysisText;
            
            // Update pivot points
            document.getElementById('pivot').innerHTML = `<i class="fas fa-bullseye"></i> PIVOT POINT = <span>${results.pivot}</span>`;
            document.getElementById('r1').innerHTML = `R1: <span>${results.r1}</span>`;
            document.getElementById('r2').innerHTML = `R2: <span>${results.r2}</span>`;
            document.getElementById('r3').innerHTML = `R3: <span>${results.r3}</span>`;
            document.getElementById('r4').innerHTML = `R4: <span>${results.r4}</span>`;
            document.getElementById('s1').innerHTML = `S1: <span>${results.s1}</span>`;
            document.getElementById('s2').innerHTML = `S2: <span>${results.s2}</span>`;
            document.getElementById('s3').innerHTML = `S3: <span>${results.s3}</span>`;
            document.getElementById('s4').innerHTML = `S4: <span>${results.s4}</span>`;
            
            // Update signature
            document.getElementById('signature-result').textContent = signature || "Kahfi";
            
            // Update berita terkini
            const newsDisplay = document.getElementById('news-display');
            const newsText = document.getElementById('news-text');
            if (notes && notes.trim() !== "") {
                newsText.textContent = notes;
                newsDisplay.style.display = 'block';
            } else {
                newsDisplay.style.display = 'none';
            }
            
            // Update market indicator
            const marketIndicator = document.getElementById('marketIndicator');
            marketIndicator.textContent = marketConfig[currentMarket].name;
            marketIndicator.className = `market-indicator ${marketConfig[currentMarket].indicatorClass}`;
            
            // Update period indicator
            const periodIndicator = document.getElementById('periodIndicator');
            periodIndicator.textContent = periodConfigCurrent.name;
            periodIndicator.className = `period-indicator ${periodConfigCurrent.indicatorClass}`;
            
            showNotification(`${periodConfigCurrent.name} pivot point calculation completed successfully!`, "success");
        }
        
        // Fungsi untuk reset form
        function resetForm() {
            document.getElementById('open').value = '';
            document.getElementById('high').value = '';
            document.getElementById('low').value = '';
            document.getElementById('close').value = '';
            document.getElementById('signature').value = 'Kahfi';
            document.getElementById('notes').value = '';
            
            // Set tanggal berdasarkan periode saat ini
            const today = new Date();
            
            if (currentPeriod === 'daily') {
                const formattedDate = today.toISOString().split('T')[0];
                document.getElementById('date').value = formattedDate;
                
                // Set tanggal besok untuk analisis
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                const formattedTomorrow = tomorrow.toISOString().split('T')[0];
                document.getElementById('analysisDateStart').value = formattedTomorrow;
            } else if (currentPeriod === 'weekly') {
                // Set rentang tanggal minggu ini (Senin sampai Jumat)
                const startOfWeek = new Date(today);
                startOfWeek.setDate(today.getDate() - today.getDay() + (today.getDay() === 0 ? -6 : 1));
                const formattedStartDate = startOfWeek.toISOString().split('T')[0];
                
                const endOfWeek = new Date(startOfWeek);
                endOfWeek.setDate(startOfWeek.getDate() + 4); // 5 hari kerja
                const formattedEndDate = endOfWeek.toISOString().split('T')[0];
                
                document.getElementById('dateStart').value = formattedStartDate;
                document.getElementById('dateEnd').value = formattedEndDate;
                
                // Set rentang tanggal minggu depan
                const nextWeekStart = new Date(startOfWeek);
                nextWeekStart.setDate(startOfWeek.getDate() + 7);
                const formattedNextWeekStart = nextWeekStart.toISOString().split('T')[0];
                
                const nextWeekEnd = new Date(endOfWeek);
                nextWeekEnd.setDate(endOfWeek.getDate() + 7);
                const formattedNextWeekEnd = nextWeekEnd.toISOString().split('T')[0];
                
                document.getElementById('analysisDateStart').value = formattedNextWeekStart;
                document.getElementById('analysisDateEnd').value = formattedNextWeekEnd;
            } else if (currentPeriod === 'monthly') {
                // Set rentang tanggal bulan ini (tanggal 1 sampai akhir bulan)
                const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
                const formattedStartDate = startOfMonth.toISOString().split('T')[0];
                
                const endOfMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0);
                const formattedEndDate = endOfMonth.toISOString().split('T')[0];
                
                document.getElementById('dateStart').value = formattedStartDate;
                document.getElementById('dateEnd').value = formattedEndDate;
                
                // Set rentang tanggal bulan depan
                const nextMonthStart = new Date(today.getFullYear(), today.getMonth() + 1, 1);
                const formattedNextMonthStart = nextMonthStart.toISOString().split('T')[0];
                
                const nextMonthEnd = new Date(today.getFullYear(), today.getMonth() + 2, 0);
                const formattedNextMonthEnd = nextMonthEnd.toISOString().split('T')[0];
                
                document.getElementById('analysisDateStart').value = formattedNextMonthStart;
                document.getElementById('analysisDateEnd').value = formattedNextMonthEnd;
            }
            
            showNotification("Form has been reset. Please enter new data.", "success");
        }
        
        // Fungsi untuk mendownload hasil sebagai PDF
        function downloadResults() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            
            const marketConfigCurrent = marketConfig[currentMarket];
            const periodConfigCurrent = periodConfig[currentPeriod];
            
            // Background color
            doc.setFillColor(18, 30, 52);
            doc.rect(0, 0, 210, 297, 'F');
            
            // Judul dengan gradient effect
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(22);
            doc.setFont(undefined, 'bold');
            doc.text('PIVOT POINT PRO ANALYSIS', 105, 25, null, null, 'center');
            
            doc.setFontSize(14);
            doc.text(`${marketConfigCurrent.name} - ${periodConfigCurrent.name}`, 105, 35, null, null, 'center');
            
            doc.setFontSize(10);
            doc.setTextColor(6, 214, 160);
            doc.text('PT RFB CIPUTRA SURABAYA', 105, 42, null, null, 'center');
            
            // Garis dekoratif
            doc.setDrawColor(255, 107, 0);
            doc.setLineWidth(0.5);
            doc.line(20, 48, 190, 48);
            
            // Periode analisis
            doc.setTextColor(255, 209, 102);
            doc.setFontSize(11);
            doc.text(`Analysis Period: ${document.getElementById('result-date').textContent}`, 20, 60);
            
            // Data pasar
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            doc.text('MARKET DATA', 20, 75);
            
            doc.setFont(undefined, 'normal');
            const marketData = [
                `Open: ${document.getElementById('result-open').textContent}`,
                `High: ${document.getElementById('result-high').textContent}`,
                `Low: ${document.getElementById('result-low').textContent}`,
                `Close: ${document.getElementById('result-close').textContent}`,
                `Price Movement Range: ${document.getElementById('result-range').textContent}`
            ];
            
            marketData.forEach((item, index) => {
                doc.text(item, 20, 85 + (index * 7));
            });
            
            // Info profit
            const profitText = document.getElementById('point-value-text').textContent;
            doc.text(profitText, 20, 120);
            doc.text(`Taking Profit Probability based on movement range of ${document.getElementById('result-range-value').textContent} points:`, 20, 127);
            doc.text(`USD: ${document.getElementById('profit-usd').textContent}`, 25, 134);
            doc.text(`IDR: ${document.getElementById('profit-idr').textContent}`, 25, 141);
            
            // Analisis periode berikutnya
            const analysisDate = document.getElementById('analysis-date-result').textContent;
            
            doc.setFont(undefined, 'bold');
            doc.setTextColor(255, 209, 102);
            doc.text(`${periodConfigCurrent.analysisText}: ${analysisDate}`, 20, 155);
            
            // Resistance
            doc.setFontSize(11);
            doc.setTextColor(255, 107, 107);
            doc.text('RESISTANCE LEVELS', 20, 165);
            doc.setTextColor(255, 255, 255);
            
            const resistanceLevels = [
                `R1: ${document.querySelector('#r1 span').textContent}`,
                `R2: ${document.querySelector('#r2 span').textContent}`,
                `R3: ${document.querySelector('#r3 span').textContent}`,
                `R4: ${document.querySelector('#r4 span').textContent}`
            ];
            
            resistanceLevels.forEach((item, index) => {
                doc.text(item, 20, 172 + (index * 7));
            });
            
            // Pivot
            doc.setFont(undefined, 'bold');
            doc.setTextColor(255, 209, 102);
            doc.text(`PIVOT POINT = ${document.querySelector('#pivot span').textContent}`, 20, 202);
            
            // Support
            doc.setFontSize(11);
            doc.setTextColor(6, 214, 160);
            doc.text('SUPPORT LEVELS', 20, 212);
            doc.setTextColor(255, 255, 255);
            
            const supportLevels = [
                `S1: ${document.querySelector('#s1 span').textContent}`,
                `S2: ${document.querySelector('#s2 span').textContent}`,
                `S3: ${document.querySelector('#s3 span').textContent}`,
                `S4: ${document.querySelector('#s4 span').textContent}`
            ];
            
            supportLevels.forEach((item, index) => {
                doc.text(item, 20, 219 + (index * 7));
            });
            
            // Tanda tangan
            const signature = document.getElementById('signature-result').textContent;
            doc.setFont(undefined, 'italic');
            doc.setTextColor(166, 179, 204);
            doc.text('Best regards,', 20, 245);
            doc.setFont(undefined, 'bold');
            doc.setTextColor(255, 255, 255);
            doc.text(signature, 20, 252);
            doc.setFont(undefined, 'normal');
            doc.setTextColor(6, 214, 160);
            doc.text('PT RFB CIPUTRA SURABAYA', 20, 259);
            
            // PERBAIKAN: Market News dengan warna kontras yang lebih baik
            const newsDisplay = document.getElementById('news-display');
            if (newsDisplay.style.display !== 'none') {
                const newsText = document.getElementById('news-text').textContent;
                doc.setFont(undefined, 'bold');
                doc.setTextColor(255, 209, 102); // Warna emas untuk judul
                doc.text('MARKET NEWS:', 20, 270);
                doc.setFont(undefined, 'normal');
                doc.setTextColor(255, 255, 255); // Warna putih untuk konten
                
                // Split text into lines that fit within page width
                const splitText = doc.splitTextToSize(newsText, 170);
                doc.text(splitText, 20, 277);
                
                // Tambahkan garis dekoratif di bawah market news
                doc.setDrawColor(255, 209, 102);
                doc.setLineWidth(0.3);
                doc.line(20, 268, 190, 268);
            }
            
            // Simpan PDF
            const date = new Date();
            const dateStr = date.toISOString().split('T')[0].replace(/-/g, '');
            doc.save(`Pivot_Analysis_${marketConfigCurrent.name}_${periodConfigCurrent.name}_${dateStr}.pdf`);
            
            showNotification("Analysis exported successfully as PDF!", "success");
        }
        
        // Fungsi untuk mengubah jenis pasar
        function changeMarketType(marketType) {
            currentMarket = marketType;
            document.getElementById('marketType').value = marketType;
            
            // Update tampilan opsi pasar
            document.getElementById('goldOption').classList.remove('active');
            document.getElementById('hangsengOption').classList.remove('active');
            
            if (marketType === 'gold') {
                document.getElementById('goldOption').classList.add('active');
            } else {
                document.getElementById('hangsengOption').classList.add('active');
            }
            
            // Update hasil jika sudah ada perhitungan
            const open = parseFloat(document.getElementById('open').value);
            if (!isNaN(open)) {
                updateResults();
            }
        }
        
        // Fungsi untuk mengubah periode analisis
        function changePeriodType(periodType) {
            currentPeriod = periodType;
            document.getElementById('periodType').value = periodType;
            
            // Update tampilan opsi periode
            document.getElementById('dailyOption').classList.remove('active');
            document.getElementById('weeklyOption').classList.remove('active');
            document.getElementById('monthlyOption').classList.remove('active');
            
            document.getElementById(`${periodType}Option`).classList.add('active');
            
            // Update input fields berdasarkan periode
            updatePeriodInputs();
            
            // Reset tanggal berdasarkan periode baru
            resetForm();
            
            // Update hasil jika sudah ada perhitungan
            const open = parseFloat(document.getElementById('open').value);
            if (!isNaN(open)) {
                updateResults();
            }
        }
        
        // Event listeners
        document.getElementById('calculateBtn').addEventListener('click', updateResults);
        document.getElementById('resetBtn').addEventListener('click', resetForm);
        document.getElementById('downloadBtn').addEventListener('click', downloadResults);
        
        // Event listener untuk pilihan pasar
        document.getElementById('goldOption').addEventListener('click', () => changeMarketType('gold'));
        document.getElementById('hangsengOption').addEventListener('click', () => changeMarketType('hangseng'));
        
        // Event listener untuk pilihan periode
        document.getElementById('dailyOption').addEventListener('click', () => changePeriodType('daily'));
        document.getElementById('weeklyOption').addEventListener('click', () => changePeriodType('weekly'));
        document.getElementById('monthlyOption').addEventListener('click', () => changePeriodType('monthly'));
        
        // Hitung otomatis saat halaman dimuat
        window.addEventListener('DOMContentLoaded', () => {
            // Set nilai default berdasarkan periode
            updatePeriodInputs();
            resetForm();
            
            // Hitung dengan nilai default
            updateResults();
        });
    </script>
</body>
</html>
